flowchart LR
    Client["Browser / React Frontend"]
    Admin["Admin Browser"]

    subgraph Backend["FastAPI Backend"]
        direction LR

        subgraph API["API Layer"]
            AuthAPI["auth.py /auth/*"]
            BlogsAPI["blogs.py /blogs/*"]
            FRAPI["feature_requests.py /feature-requests/*"]
            SessionAPI["session.py /session/draft"]
            NotifAPI["notifications.py /notifications/sse"]
        end

        subgraph Core["Core and Infra"]
            Config["core.config"]
            Security["core.security"]
            Deps["deps.py"]
            DBSession["db.session"]
        end

        subgraph Domain["Domain and CRUD"]
            Models["Models: User, Blog, FeatureRequest, Draft"]
            Schemas["Schemas: User, Blog, FeatureRequest, Draft"]
            CRUD["CRUD: blog, feature_request, draft"]
        end

        subgraph Realtime["Realtime Services"]
            Notifier["NotificationManager for SSE"]
            ChatMgr["BlogChatManager for WebSockets"]
        end
    end

    DB["PostgreSQL or SQLite"]

    %% Client → API
    Client -->|"REST JSON"| AuthAPI
    Client -->|"REST JSON"| BlogsAPI
    Client -->|"REST JSON"| FRAPI
    Client -->|"REST JSON"| SessionAPI

    Admin -->|"SSE stream"| NotifAPI
    Client -->|"WebSocket /blogs/{id}/ws"| BlogsAPI

    %% API → Core
    AuthAPI --> Security
    BlogsAPI --> Security
    FRAPI --> Security
    SessionAPI --> Security

    AuthAPI --> Deps
    BlogsAPI --> Deps
    FRAPI --> Deps
    SessionAPI --> Deps

    %% API → Domain / Realtime
    BlogsAPI --> CRUD
    FRAPI --> CRUD
    SessionAPI --> CRUD

    BlogsAPI --> ChatMgr
    NotifAPI --> Notifier

    %% CRUD → DB
    CRUD --> DB
    DBSession --> DB
